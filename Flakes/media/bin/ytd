#!/usr/bin/env bash

if [ -z "$1" ]; then
	printf "Usage: yt-download <url> [quality]\n"
	printf "Quality options: best, 1080p, 720p, 480p, audio\n"
	exit 1
fi

URL="$1"
QUALITY="${2:-1080p}"

case $QUALITY in
	"best")
		/nix/store/8bk9vw8bk10x3g0r60mp1yxinfbwx4gd-yt-dlp-2025.1.26/bin/yt-dlp "$URL"
		;;
	"audio")
		/nix/store/8bk9vw8bk10x3g0r60mp1yxinfbwx4gd-yt-dlp-2025.1.26/bin/yt-dlp -x --audio-format mp3 "$URL"
		;;
	*)
		/nix/store/8bk9vw8bk10x3g0r60mp1yxinfbwx4gd-yt-dlp-2025.1.26/bin/yt-dlp -f "bestvideo[height<=${QUALITY%p}]+bestaudio/best[height<=${QUALITY%p}]" "$URL"
		;;
esac
