#!/bin/sh
#shellcheck enable=all

#@ Set defaults
set -eu
scr_path="$0"
src_name="$(basename "${scr_path}")"
workspace="${1:-"${DOTS}"}"

print_error() {
  printf "[ERROR] %s ===" "${src_name}" "$*" >&2
  exit 1
}

#@ Ensure the DOTS variable is defined
[ -n "${workspace}" ] || {
  print_error "The path to DOTS directory must be set.\n" >&2
}

#@ Use devnix from here on
CMD_DEVNIX="$(command -v devnix 2>/dev/null)"
CMD_DEVNIX="${CMD_DEVNIX:-"${workspace}/Bin/shellscript/project/nix/devnix"}"
if [ -x "${CMD_DEVNIX}" ]; then
  "${CMD_DEVNIX}" "${workspace}"
else
  print_error "Missing loader script:" "${CMD_DEVNIX}"
fi
